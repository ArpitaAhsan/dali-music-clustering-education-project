import pandas as pd
import numpy as np
import os
from src.dataset import load_dataset, get_mfcc_features  # Remove csv import
from src.clustering import run_kmeans, evaluate_clusters
os.makedirs('results', exist_ok=True)
df = load_dataset()
X, _ = get_mfcc_features(df)
scores = []
for k in range(3, 13):
    _, labels = run_kmeans(X, k)
    score = evaluate_clusters(X, labels)
    score['k'] = k
    scores.append(score)
df_scores = pd.DataFrame(scores).set_index('k')
df_scores.to_csv('results/clustering_metrics.csv', index_label='k')
print(df_scores.round(4))
